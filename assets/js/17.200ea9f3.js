(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{218:function(t,s,a){"use strict";a.r(s);var n=a(0),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"page-title"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#page-title","aria-hidden":"true"}},[t._v("#")]),t._v(" "+t._s(t.$page.title))]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://docs.gradle.org/current/userguide/init_scripts.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文链接"),a("OutboundLink")],1)])]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#基本用法"}},[t._v("基本用法")])]),a("li",[a("a",{attrs:{href:"#使用初始化脚本"}},[t._v("使用初始化脚本")])]),a("li",[a("a",{attrs:{href:"#编写一个初始化脚本"}},[t._v("编写一个初始化脚本")]),a("ul",[a("li",[a("a",{attrs:{href:"#通过初始化脚本配置项目"}},[t._v("通过初始化脚本配置项目")])]),a("li",[a("a",{attrs:{href:"#应用初始化脚本时的输出"}},[t._v("应用初始化脚本时的输出")])])])]),a("li",[a("a",{attrs:{href:"#初始化脚本的外部依赖关系"}},[t._v("初始化脚本的外部依赖关系")])]),a("li",[a("a",{attrs:{href:"#初始化脚本插件"}},[t._v("初始化脚本插件")])])])]),a("p"),t._v(" "),a("p",[t._v("Gradle提供了一个强大的机制，允许基于当前环境定制构建。该机制还支持希望与Gradle集成的工具。")]),t._v(" "),a("p",[t._v("请注意，这与“"),a("code",[t._v("build-init")]),t._v("”插件提供的“"),a("code",[t._v("init")]),t._v("”任务完全不同（请参阅"),a("a",{attrs:{href:"https://docs.gradle.org/current/userguide/build_init_plugin.html#build_init_plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("Build Init插件"),a("OutboundLink")],1),t._v("）。")]),t._v(" "),a("h2",{attrs:{id:"基本用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本用法","aria-hidden":"true"}},[t._v("#")]),t._v(" 基本用法")]),t._v(" "),a("p",[t._v("初始化脚本（"),a("strong",[t._v("Initialization scripts")]),t._v(", a.k.a. "),a("strong",[t._v("init scripts")]),t._v("）与Gradle中的其他脚本相似。但是，这些脚本是在构建开始之前运行的。以下是几种可能的用途：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("设置企业范围的配置，例如在哪里可以找到自定义插件。")])]),t._v(" "),a("li",[a("p",[t._v("根据当前环境设置属性，例如开发人员的计算机与持续集成服务器。")])]),t._v(" "),a("li",[a("p",[t._v("提供构建所需的有关用户的个人信息，例如存储库或数据库身份验证凭据。")])]),t._v(" "),a("li",[a("p",[t._v("定义机器特定的详细信息，例如JDK的安装位置。")])]),t._v(" "),a("li",[a("p",[t._v("注册构建侦听器。希望监听Gradle事件的外部工具可能会发现这很有用。")])]),t._v(" "),a("li",[a("p",[t._v("注册构建记录器。您可能希望自定义Gradle如何记录它生成的事件。")])])]),t._v(" "),a("p",[t._v("初始化脚本的一个主要限制是它们不能访问"),a("code",[t._v("buildSrc")]),t._v("项目中的类（有关此功能的详细信息，请参见"),a("a",{attrs:{href:"https://docs.gradle.org/current/userguide/organizing_gradle_projects.html#sec:build_sources",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用buildSrc提取命令式逻辑"),a("OutboundLink")],1),t._v("）。")]),t._v(" "),a("h2",{attrs:{id:"使用初始化脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用初始化脚本","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用初始化脚本")]),t._v(" "),a("p",[t._v("有几种使用初始化脚本的方法：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("在命令行上指定一个文件。命令行选项是"),a("code",[t._v("-I")]),t._v("或"),a("code",[t._v("--init-script")]),t._v("，后跟脚本路径。命令行选项可以多次出现，每次添加另一个初始化脚本。如果命令行上指定的任何文件不存在，则构建将失败。")])]),t._v(" "),a("li",[a("p",[t._v("将一个名为"),a("code",[t._v("init.gradle")]),t._v("的文件（或Kotlin的"),a("code",[t._v("init.gradle.kts")]),t._v("）放在"),a("code",[t._v("USER_HOME/.gradle/")]),t._v("目录中。")])]),t._v(" "),a("li",[a("p",[t._v("将以"),a("code",[t._v(".gradle")]),t._v("（或Kotlin的"),a("code",[t._v(".init.gradle.kts")]),t._v("）结尾的文件放在"),a("code",[t._v("USER_HOME/.gradle/init.d/")]),t._v("目录中。")])]),t._v(" "),a("li",[a("p",[t._v("将以"),a("code",[t._v(".gradle")]),t._v("（或Kotlin的"),a("code",[t._v(".init.gradle.kts")]),t._v("）结尾的文件放在Gradle发行版的"),a("code",[t._v("GRADLE_HOME/init.d/")]),t._v("目录中。这使您可以打包包含一些自定义构建逻辑和插件的自定义Gradle发行版。您可以将其与"),a("a",{attrs:{href:"https://docs.gradle.org/current/userguide/gradle_wrapper.html#gradle_wrapper",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gradle wrapper"),a("OutboundLink")],1),t._v("结合使用，以使自定义逻辑可用于企业中的所有内部版本。")])])]),t._v(" "),a("p",[t._v("如果发现一个以上的初始化脚本，它们将全部按照上述指定的顺序执行。给定目录中的脚本 "),a("strong",[t._v("按字母顺序执行")]),t._v("。例如，这允许使用一种工具在命令行上指定一个初始化脚本，并且用户可以将一个脚本放入其主目录中以定义环境，并且在执行Gradle时，这两个脚本都将运行。")]),t._v(" "),a("h2",{attrs:{id:"编写一个初始化脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写一个初始化脚本","aria-hidden":"true"}},[t._v("#")]),t._v(" 编写一个初始化脚本")]),t._v(" "),a("p",[t._v("类似于Gradle构建脚本，初始化脚本是Groovy或Kotlin脚本。每个初始化脚本都有一个与之关联的"),a("a",{attrs:{href:"https://docs.gradle.org/current/dsl/org.gradle.api.invocation.Gradle.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gradle"),a("OutboundLink")],1),t._v("实例。初始化脚本中的任何属性引用和方法调用都将委托给此"),a("code",[t._v("Gradle")]),t._v("实例。")]),t._v(" "),a("p",[t._v("每个初始化脚本还实现"),a("a",{attrs:{href:"https://docs.gradle.org/current/dsl/org.gradle.api.Script.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("脚本"),a("OutboundLink")],1),t._v("接口。")]),t._v(" "),a("h3",{attrs:{id:"通过初始化脚本配置项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过初始化脚本配置项目","aria-hidden":"true"}},[t._v("#")]),t._v(" 通过初始化脚本配置项目")]),t._v(" "),a("p",[t._v("您可以使用初始化脚本来配置构建中的项目。这与在多项目构建中配置项目的方式类似。以下示例显示了在评估项目之前如何通过初始化脚本执行额外的配置。此样本使用此功能来配置额外的存储库，以仅用于某些环境。")]),t._v(" "),a("p",[t._v("示例1.在评估项目之前，使用初始化脚本执行额外的配置")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build.gradle")]),t._v("\n\nrepositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ntask showRepos "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    doLast "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        println "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"All repos:"')]),t._v("\n        println repositories"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("collect "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" it"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle")]),t._v("\n\nallprojects "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenLocal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-kotlin extra-class"},[a("pre",{pre:!0,attrs:{class:"language-kotlin"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build.gradle.kts")]),t._v("\n\nrepositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ntasks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"showRepos"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    doLast "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"All repos:"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//TODO:kotlin-dsl remove filter once we're no longer on a kotlin eap")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("repositories"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" it"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("filter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" it "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"maven"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle.kts")]),t._v("\n\nallprojects "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenLocal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("h3",{attrs:{id:"应用初始化脚本时的输出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用初始化脚本时的输出","aria-hidden":"true"}},[t._v("#")]),t._v(" 应用初始化脚本时的输出")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-sh extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gradle --init-script init.gradle -q showRepos\nAll repos:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MavenLocal, MavenRepo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-sh extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gradle --init-script init.gradle.kts -q showRepos\nAll repos:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MavenLocal, MavenRepo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("h2",{attrs:{id:"初始化脚本的外部依赖关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化脚本的外部依赖关系","aria-hidden":"true"}},[t._v("#")]),t._v(" 初始化脚本的外部依赖关系")]),t._v(" "),a("p",[t._v("在构建脚本的外部依赖关系中，说明了如何向构建脚本添加外部依赖关系。初始化脚本也可以声明依赖关系。您可以使用"),a("code",[t._v("initscript()")]),t._v("方法执行此操作，并传入一个声明初始化脚本类路径的闭包。")]),t._v(" "),a("p",[t._v("示例2.声明一个初始化脚本的外部依赖")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle")]),t._v("\n\ninitscript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        classpath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'org.apache.commons:commons-math:2.0'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-kotlin extra-class"},[a("pre",{pre:!0,attrs:{class:"language-kotlin"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle.kts")]),t._v("\n\ninitscript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("classpath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"org.apache.commons:commons-math:2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("p",[t._v("传递给"),a("code",[t._v("initscript()")]),t._v("方法的闭包可配置"),a("a",{attrs:{href:"https://docs.gradle.org/current/javadoc/org/gradle/api/initialization/dsl/ScriptHandler.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ScriptHandler"),a("OutboundLink")],1),t._v("实例。您可以通过将依赖项添加到类路径配置中来声明初始化脚本类路径。这与您声明Java编译类路径的方式相同。可以使用"),a("a",{attrs:{href:"https://docs.gradle.org/current/userguide/declaring_dependencies.html#declaring_dependencies",target:"_blank",rel:"noopener noreferrer"}},[t._v("Declaring Dependencies"),a("OutboundLink")],1),t._v("中描述的任何依赖项类型，项目依赖项除外。")]),t._v(" "),a("p",[t._v("声明了初始化脚本的类路径后，您可以像使用该类路径上的任何其他类一样，使用初始化脚本中的类。以下示例将添加到前面的示例中，并使用初始化脚本类路径中的类。")]),t._v(" "),a("p",[t._v("示例3.具有外部依赖关系的初始化脚本")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("commons"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("fraction"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("Fraction\n\ninitscript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        classpath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'org.apache.commons:commons-math:2.0'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nprintln Fraction"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("ONE_FIFTH"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("multiply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-kotlin extra-class"},[a("pre",{pre:!0,attrs:{class:"language-kotlin"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle.kts")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commons"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fraction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Fraction\n\ninitscript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("classpath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"org.apache.commons:commons-math:2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Fraction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ONE_FIFTH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("multiply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("p",[t._v("应用初始化脚本时的输出")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-sh extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gradle --init-script init.gradle -q doNothing\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" / "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-sh extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gradle --init-script init.gradle.kts -q doNothing\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" / "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("h2",{attrs:{id:"初始化脚本插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化脚本插件","aria-hidden":"true"}},[t._v("#")]),t._v(" 初始化脚本插件")]),t._v(" "),a("p",[t._v("类似于Gradle构建脚本或Gradle设置文件，可以将插件应用于初始化脚本。")]),t._v(" "),a("p",[t._v("示例4.在初始化脚本中使用插件")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("commons"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("fraction"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("Fraction\n\ninitscript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        classpath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'org.apache.commons:commons-math:2.0'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nprintln Fraction"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("ONE_FIFTH"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("multiply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-kotlin extra-class"},[a("pre",{pre:!0,attrs:{class:"language-kotlin"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle.kts")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commons"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fraction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Fraction\n\ninitscript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("classpath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"org.apache.commons:commons-math:2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Fraction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ONE_FIFTH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("multiply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("p",[t._v("应用初始化脚本时的输出")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle")]),t._v("\n\napply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" EnterpriseRepositoryPlugin\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EnterpriseRepositoryPlugin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Plugin")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Gradle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" String ENTERPRISE_REPOSITORY_URL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"https://repo.gradle.org/gradle/repo"')]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Gradle gradle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ONLY USE ENTERPRISE REPO FOR DEPENDENCIES")]),t._v("\n        gradle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("allprojects "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" project "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n            project"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Remove all repositories not pointing to the enterprise repository url")]),t._v("\n                all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" ArtifactRepository repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("repo "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MavenArtifactRepository")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v("\n                          repo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" ENTERPRISE_REPOSITORY_URL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        project"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("lifecycle "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"Repository '),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("repo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" removed. Only "),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),t._v("ENTERPRISE_REPOSITORY_URL")]),t._v(' is allowed"')]),t._v("\n                        remove repo\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add the enterprise repository")]),t._v("\n                maven "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    name "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"STANDARD_ENTERPRISE_REPO"')]),t._v("\n                    url ENTERPRISE_REPOSITORY_URL\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build.gradle")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/*\n * Copyright 2013 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// tag::show-repos-task[]")]),t._v("\nrepositories"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n task showRepositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     doLast "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         repositories"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("each "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n             println "),a("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"repository: '),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("it"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" ('"),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("it"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("')\"")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// end::show-repos-task[]")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-kotlin extra-class"},[a("pre",{pre:!0,attrs:{class:"language-kotlin"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// init.gradle.kts")]),t._v("\n\napply"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("EnterpriseRepositoryPlugin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" EnterpriseRepositoryPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Plugin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Gradle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("companion")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" ENTERPRISE_REPOSITORY_URL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://repo.gradle.org/gradle/repo"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fun")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gradle"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Gradle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ONLY USE ENTERPRISE REPO FOR DEPENDENCIES")]),t._v("\n        gradle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("allprojects")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Remove all repositories not pointing to the enterprise repository url")]),t._v("\n                all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" MavenArtifactRepository "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" ENTERPRISE_REPOSITORY_URL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        project"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lifecycle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Repository '),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token delimiter variable"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" MavenArtifactRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?:")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token delimiter variable"}},[t._v("}")])]),t._v(" removed. Only "),a("span",{pre:!0,attrs:{class:"token interpolation variable"}},[t._v("$ENTERPRISE_REPOSITORY_URL")]),t._v(' is allowed"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add the enterprise repository")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maven "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"STANDARD_ENTERPRISE_REPO"')]),t._v("\n                    url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ENTERPRISE_REPOSITORY_URL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build.gradle.kts")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// tag::show-repos-task[]")]),t._v("\nrepositories"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mavenCentral")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ntasks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"showRepositories"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    doLast "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        repositories"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" it "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" MavenArtifactRepository "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"repository: '),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token delimiter variable"}},[t._v("${")]),t._v("it"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token delimiter variable"}},[t._v("}")])]),t._v(" ('"),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token delimiter variable"}},[t._v("${")]),t._v("it"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token delimiter variable"}},[t._v("}")])]),t._v("')\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// end::show-repos-task[]")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("p",[t._v("应用初始化脚本时的输出")]),t._v(" "),a("CodeSwitcher",{attrs:{languages:{groovy:"Groovy",kotlin:"Kotlin"}},scopedSlots:t._u([{key:"groovy",fn:function(){return[a("div",{staticClass:"language-sh extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gradle --init-script init.gradle -q showRepositories\nrepository: STANDARD_ENTERPRISE_REPO "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://repo.gradle.org/gradle/repo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]},proxy:!0},{key:"kotlin",fn:function(){return[a("div",{staticClass:"language-sh extra-class"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gradle --init-script init.gradle.kts -q showRepositories\nrepository: STANDARD_ENTERPRISE_REPO "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://repo.gradle.org/gradle/repo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]},proxy:!0}])}),t._v(" "),a("p",[t._v("初始化脚本中的插件可确保在运行构建时仅使用指定的存储库。")]),t._v(" "),a("p",[t._v("在初始化脚本中应用插件时，Gradle实例化插件并调用插件实例的"),a("a",{attrs:{href:"1"}},[t._v("Plugin.apply(T)")]),t._v("方法。"),a("code",[t._v("gradle")]),t._v("对象作为参数传递，可用于配置构建的各个方面。当然，可以将应用的插件解析为外部依赖项，如"),a("a",{attrs:{href:"#%E5%88%9D%E5%A7%8B%E5%8C%96%E8%84%9A%E6%9C%AC%E7%9A%84%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"}},[t._v("初始化脚本的外部依赖项")]),t._v("中所述")])],1)}),[],!1,null,null,null);s.default=r.exports}}]);